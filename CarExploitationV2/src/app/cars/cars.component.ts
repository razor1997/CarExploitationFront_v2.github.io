import { Component, OnInit } from '@angular/core';
import { Car } from 'app/_models/car';
import {NgxGalleryImageSize, NgxGalleryOptions} from '@kolkov/ngx-gallery';
import {NgxGalleryImage} from '@kolkov/ngx-gallery';
import {NgxGalleryAnimation} from '@kolkov/ngx-gallery';
import { Lightbox } from 'ngx-lightbox';
import { Observable } from 'rxjs';
import { CarsService } from 'app/_services/cars.service';
import {MatDialog} from '@angular/material/dialog';
import { CarAddComponent } from 'app/car-add/car-add.component';


const LIST_CARS: Car[] = [
  { mark: 'Saab', model: '95', mileage: 180000, yearProduction: 1998, buyCost: 12000, engine: 2000, engineType: 2 },
  { mark: 'BMW',  model: 'M4', mileage: 12000,  yearProduction: 2015, buyCost: 200000, engine: 3000, engineType: 0  }, 
  { mark: 'Mercedes-Benz', model: 'C63', mileage: 180000, yearProduction: 1998, buyCost: 12000, engine: 6200, engineType: 0  },
  { mark: 'Lexus', model: 'IS', mileage: 200000, yearProduction: 2005, buyCost: 25000, engine: 2500, engineType: 1  },
  { mark: 'Tesla', model: 'Model S', mileage: 50000, yearProduction: 2012, buyCost: 250000, engine: 0, engineType: 3  },
  { mark: 'Toyota', model: 'Camry', mileage: 200000, yearProduction: 2010, buyCost: 25000, engine: 2500, engineType: 1  }
];

@Component({
  selector: 'app-cars',

  templateUrl: './cars.component.html',
  styleUrls: ['./cars.component.css']
})

export class CarsComponent {
  dataSource = LIST_CARS;
  namesOfColumns: string[] = ['image','mark', 'model', 'mileage', 'yearProduction', 'buyCost', 'engine', 'engineType','update','delete'];
  galleryOptions: NgxGalleryOptions[] | undefined;
  galleryImages: NgxGalleryImage[] | undefined;
  _album:any = [];
  cars$: Observable <Car[]>; 
  car: Car;
  openEditDialog: boolean;
  addCarForm: any;
  ModalTitle = "";
  constructor(private _lightbox: Lightbox, 
              private _carsService: CarsService,
              public dialog: MatDialog) {
               
    for (let i = 1; i <= 3; i++) {
      const src = 'https://res.cloudinary.com/dksxe4clc/image/upload/v1659296773/yszl9srbgghbcmnmo35a.jpg';
      const caption = 'Image ' + i + ' caption here';
      const thumb = 'https://res.cloudinary.com/dksxe4clc/image/upload/v1659296773/yszl9srbgghbcmnmo35a.jpg';
      const image = {
         src: src,
         caption: caption,
         thumb: thumb
      };
      this._album.push(image);
   }
  }
  openDialog() {
    this.car = {
      appUserId: 1,
      id: 0,
      mark: "MercedesBenz",
      model: "C300",
      yearProduction: 2000,
      buyCost: 200000,
      mileage: 200000,
      engine: 3000,
      engineType: 1,
      photoUrl: ""
    }
    this.ModalTitle = "Add Department";
    this.addCarForm = {
      DepartmentId: "0",
      DepartmentName: "",
      car: this.car
    }  

    const dialogRef = this.dialog.open(CarAddComponent,
      {
        width: '400px',
        data:
        {      
          addCarForm: this.addCarForm,
          DepartmentId: "1"
        }
      }
    );

    dialogRef.afterClosed().subscribe(result => {
      console.log(`Dialog result: ${result}`);
    });
  }    
  ngOnInit(): void {
    this.getCarList();
  }
  getCarList(){
    this.cars$ = this._carsService.getAllCars();
  }
  open(index: number): void {
    // open lightbox
    this._lightbox.open(this._album, index);
  }
 
  close(): void {
    // close lightbox programmatically
    this._lightbox.close();
  }
    addClick(){
 // this.openEditDialog = true;

  }
  closeClick() {
    this.openEditDialog = false;
    // this.getCarList();
  }
  deleteCar()
  {
    
  }
}
